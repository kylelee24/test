name: Deploy pull request environment

# only trigger on pull request closed events
on:
  pull_request:
    types: [ opened, edited, synchronize]
    # Maybe should just be opened as it is just for CD. Terraform does not need to run again.
    # Maybe label to trigger reploy as a hack
    # types: [ opened ]

jobs:
  deploy:
    runs-on: ubuntu-20.04
    steps:
      - uses: actions/checkout@v2
        with:
          repository: softchoice-corp/ctt-radar-terraform
          ref: main
          token: ${{ secrets.CLONE_PERSONAL_ACCESS_TOKEN }}
          submodules: true
      - run: ls -lR
      - run: terraform version
      - run: az version
# DUMMY LINE      
# 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
# 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
# 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 